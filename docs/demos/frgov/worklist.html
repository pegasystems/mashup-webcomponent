<!DOCTYPE html>
<html lang="fr" data-fr-scheme="system">

<head>
  <title>Pega GovFR</title>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link rel="apple-touch-icon" href="./assets/img/apple-touch-icon.png"><!-- 180×180 -->
  <link rel="icon" href="./assets/img/favicon.svg" type="image/svg+xml">
  <link rel="shortcut icon" href="./assets/img/favicon.ico" type="image/x-icon"><!-- 32×32 -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" href="./assets/css/dsfr.min.css">
  <link rel="stylesheet" href="./app.css" type="text/css">
</head>

<body>
  <div class="fr-skiplinks">
    <nav class="fr-container" role="navigation" aria-label="Accès rapide">
      <ul class="fr-skiplinks__list">
        <li>
          <a class="fr-link" href="#main-content">Contenu</a>
        </li>
        <li>
          <a class="fr-link" href="#header-navigation">Menu</a>
        </li>
        <li>
          <a class="fr-link" href="#footer">Pied de page</a>
        </li>
      </ul>
    </nav>
  </div>
  <header role="banner" class="fr-header">
    <div class="fr-header__body">
      <div class="fr-container">
        <div class="fr-header__body-row">
          <div class="fr-header__brand fr-enlarge-link">
            <div class="fr-header__brand-top">
              <div class="fr-header__logo">
                <p class="fr-logo">
                  République
                  <br>Française
                </p>
              </div>
              <div class="fr-header__navbar">
                <button class="fr-btn--search fr-btn" data-fr-opened="false" aria-controls="modal-866"
                  title="Rechercher">
                  Rechercher
                </button>
                <button class="fr-btn--menu fr-btn" data-fr-opened="false" aria-controls="modal-870"
                  aria-haspopup="menu" title="Menu" id="fr-btn-menu-mobile-3">
                  Menu
                </button>
              </div>
            </div>
            <div class="fr-header__service">
              <a href="#" title="Accueil - [À MODIFIER | Nom du site / service]">
                <p class="fr-header__service-title">Application de demonstration</p>
              </a>
              <p class="fr-header__service-tagline">utilisation de la DX API</p>
            </div>
          </div>
          <div class="fr-header__tools">
            <div class="fr-header__tools-links">
              <ul class="fr-links-group">
                <li>
                  <a class="fr-link fr-fi-add-circle-line" href="#">Créer un espace</a>
                </li>
                <li>
                  <a class="fr-link fr-fi-lock-line" href="#">Se connecter</a>
                </li>
                <li>
                  <a class="fr-link fr-fi-account-line" href="#">S’enregistrer</a>
                </li>
              </ul>
            </div>
            <div class="fr-header__search fr-modal" id="modal-866">
              <div class="fr-container fr-container-lg--fluid">
                <button class="fr-link--close fr-link" aria-controls="modal-866">Fermer</button>
                <div class="fr-search-bar" id="search-865" role="search">
                  <label class="fr-label" for="search-865-input">Recherche
                  </label>
                  <input class="fr-input" placeholder="Rechercher" type="search" id="search-865-input"
                    name="search-865-input">
                  <button class="fr-btn" title="Rechercher">
                    Rechercher
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="header-navigation" class="fr-header__menu fr-modal" id="modal-870" aria-labelledby="fr-btn-menu-mobile-3">
      <div class="fr-container">
        <button class="fr-link--close fr-link" aria-controls="modal-870">Fermer</button>
        <div class="fr-header__menu-links"></div>
        <nav class="fr-nav" id="navigation-869" role="navigation" aria-label="Menu principal">
          <ul class="fr-nav__list">
            <li class="fr-nav__item">
              <a class="fr-nav__link" href="#" target="_self">Category1</a>
            </li>
            <li class="fr-nav__item">
              <a class="fr-nav__link" href="#" target="_self">Category2</a>
            </li>
            <li class="fr-nav__item">
              <a class="fr-nav__link" href="#" target="_self">Category3</a>
            </li>
            <li class="fr-nav__item">
              <a class="fr-nav__link" href="#" target="_self">Category4</a>
            </li>
          </ul>
        </nav>
      </div>
    </div>
  </header>

<main id="main-content">
</main>
<footer class="fr-footer" role="contentinfo" id="footer">
  <div class="fr-container">
    <div class="fr-footer__body">
      <div class="fr-footer__brand fr-enlarge-link">
        <a href="/" title="Retour à l’accueil">
          <p class="fr-logo" title="république française">
            république
            <br>française
          </p>
        </a>
      </div>
      <div class="fr-footer__content">
        <p class="fr-footer__content-desc">Example de pied de page</p>
        <ul class="fr-footer__content-list">
          <li class="fr-footer__content-item">
            <a class="fr-footer__content-link" href="https://legifrance.gouv.fr">legifrance.gouv.fr</a>
          </li>
          <li class="fr-footer__content-item">
            <a class="fr-footer__content-link" href="https://gouvernement.fr">gouvernement.fr</a>
          </li>
          <li class="fr-footer__content-item">
            <a class="fr-footer__content-link" href="https://service-public.fr">service-public.fr</a>
          </li>
          <li class="fr-footer__content-item">
            <a class="fr-footer__content-link" href="https://data.gouv.fr">data.gouv.fr</a>
          </li>
        </ul>
      </div>
    </div>
    <div class="fr-footer__bottom">
      <ul class="fr-footer__bottom-list">
        <li class="fr-footer__bottom-item">
          <a class="fr-footer__bottom-link" href="#">Plan du site</a>
        </li>
        <li class="fr-footer__bottom-item">
          <a class="fr-footer__bottom-link" href="#">Accessibilité: non/partiellement/totalement conforme</a>
        </li>
        <li class="fr-footer__bottom-item">
          <a class="fr-footer__bottom-link" href="#">Mentions légales</a>
        </li>
        <li class="fr-footer__bottom-item">
          <a class="fr-footer__bottom-link" href="#">Données personnelles</a>
        </li>
        <li class="fr-footer__bottom-item">
          <a class="fr-footer__bottom-link" href="#">Gestion des cookies</a>
        </li>
        <li class="fr-footer__bottom-item">
          <button class="fr-footer__bottom-link fr-fi-theme-fill fr-link--icon-left" aria-controls="fr-theme-modal"
            data-fr-opened="false">Paramètres d'affichage</button>
        </li>
      </ul>
      <div class="fr-footer__bottom-copy">
        <p>Le Gouvernement Design system est sous <a href="https://github.com/etalab/licence-ouverte/blob/master/LO.md"
            target="_blank">licence etalab-2.0</a>
        </p>
      </div>
    </div>
  </div>
</footer>

<script type="module" src="./assets/js/dsfr.module.min.js"></script>
<script src="./pega-govfr.js"></script>
<script>
  const defaultSettings = localStorage.getItem('defaultcfg');
  let defaultCfg = {
    url: "https://pw16agenda-dt1.pegacloud.io/prweb",
    portalName: "DemoReact1",
    username: "wssuser2",
    password: "install@123",
    clientid: "43524976946816519752",
    clientsecret: "90863E0C04EF929425BBC22004949762"
  };
  if (defaultSettings != null) {
    defaultCfg = JSON.parse(defaultSettings);
  }
  const elem = document.querySelector("main");
  const mytag = document.createElement("pega-govfr");
  mytag.action = 'workList';
  mytag.url = defaultCfg.url;
  mytag.username = defaultCfg.username;
  mytag.password = defaultCfg.password;
  mytag.authentication = 'oauth2password';
  mytag.clientid = defaultCfg.clientid;
  mytag.clientsecret = defaultCfg.clientsecret;
  mytag.portalName = defaultCfg.portalName;
  mytag.addEventListener("message", function (event) {
    const redirectURL = `${window.location.href.substring(0, window.location.href.lastIndexOf('/'))}`;
    if (event.detail.type === "openassignment") {
      let id = event.detail.id.replace("!", " ").split(" ");
      if (id.length > 3) {
        window.history.replaceState(
          {},
          '',
          `${redirectURL}/case.html?case=${id[2]}`,
        );
      }
    } else if (event.detail.type === "cancel") {
      window.location.href = `${redirectURL}/worklist.html`;
    }
  });
  elem.appendChild(mytag);
</script>
</body>

</html>
